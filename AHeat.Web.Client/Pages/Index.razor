@page "/"
@* @attribute [Authorize] *@
@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication

@inject NavigationManager Navigation

<PageTitle>Dashboard</PageTitle>

<MudDataGrid Items="@Devices">
    <Columns>
        <TemplateColumn>
            <CellTemplate>
                <MudText Typo="Typo.h3">@context.Item.Name</MudText>
            </CellTemplate>
        </TemplateColumn>
        <TemplateColumn CellClass="d-flex justify-end">
            <CellTemplate>
                <MudStack Row>
                    @{string stateColor = context.Item.State ? $"color:{Colors.Green.Default};" : $"color: {Colors.Red.Default};";}
                    @{bool prossesing = context.Item.Prosessing;}
                    <MudIconButton Disabled="@prossesing" Icon="@Icons.Material.Filled.PowerSettingsNew" Style="@stateColor" Size="Size.Large" @onclick="() => ToggleDevice(context.Item.Id, context.Item.State)">
                    @if (context.Item.Prosessing)
                    {
                        <MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate="true" />
                    }
                    else
                    {
                    }
                    </MudIconButton>
                </MudStack>
            </CellTemplate>
        </TemplateColumn>
    </Columns>
</MudDataGrid>
